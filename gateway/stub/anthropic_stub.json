{
   "ok":true,
   "text":"",
   "files":[
      {
         "path":"docs/harper/PLAN.md",
         "content":"# PLAN — Family Frame\n\n## Plan Snapshot\n- **Counts:** 24 REQ total / 24 open / 0 done / 0 deferred\n- **Progress:** 0% complete (0 / 24)\n- **Checklist:**\n  - [x] SPEC aligned\n  - [x] Prior REQ reconciled (no prior plan)\n  - [x] Dependencies mapped\n  - [x] KIT-readiness per REQ confirmed\n\n## Tracks & Scope Boundaries\n- **Tracks:** \n  - `App` — Core business logic (user, group, event, alert services, mobile/web clients)\n  - `Infra` — Platform setup (Kubernetes, Kafka, Postgres, S3, Auth0, observability stack)\n- **Infra Strategy:** Infra track runs in parallel but does not block App track. App REQs assume infra contracts (e.g., Postgres schema, Kafka topics, Auth0 tenant) are available via mocks/stubs during development. Infra REQs deliver production-ready deployments after App REQs validate business logic.\n- **Out of scope / Deferred:** \n  - Multi-group membership (v2)\n  - External calendar sync (v1.1)\n  - Voice assistant integration\n  - Advanced analytics dashboard\n  - Gamification features\n  - Shopping list real-time checkboxes\n  - Photo/video album management\n  - Enterprise ERP/HR integration\n  - Full GDPR audit (pilot uses GDPR-lite)\n\n## REQ-IDs Table\n\n| ID | Title | Acceptance (≤3 bullets) | DependsOn [IDs] | Track | Status |\n|---|---|---|---|---|---|\n| REQ-001 | User Registration API | POST /users/register accepts email or phone with OTP, returns userId and JWT token<br>Profile creation includes name, role dropdown, avatar upload to S3 via presigned URL<br>Registration flow completes in under 5 minutes with valid OIDC token issued | [] | App | open |\n| REQ-002 | User Profile Management API | GET /users/{userId} returns profile with name, email, phone, role, avatarUrl<br>PUT /users/{userId} updates profile fields, avatar upload generates new S3 URL<br>Avatar changes propagate to all group rosters within 10 seconds | [REQ-001] | App | open |\n| REQ-003 | Family Group Creation API | POST /groups creates group with name, icon, sets adminUserId to founder<br>Group creation returns groupId, iconUrl, admin details within 3 seconds<br>Group record persists in Postgres with correct foreign key to User | [REQ-001] | App | open |\n| REQ-004 | Group Invitation Workflow | POST /groups/{groupId}/invite generates 6-char invite code, sends email or SMS within 1 minute<br>POST /groups/{groupId}/accept validates invite code, creates GroupMember record<br>Accepted member appears in group roster within 10 seconds via WebSocket event | [REQ-003] | App | open |\n| REQ-005 | Group Member Management | GET /groups/{groupId} returns member list with userId, name, role, avatarUrl<br>DELETE /groups/{groupId}/members/{userId} removes member, admin-only authorization enforced<br>Member removal propagates to all shared calendars immediately | [REQ-003, REQ-004] | App | open |\n| REQ-006 | Event Creation API | POST /events creates event with title, startTime, endTime, recurrence, tags, attendeeIds<br>Recurring events generate instances for next 30 days, stored in EventInstance table<br>Event creation publishes event.created to Kafka within 500ms | [REQ-003] | App | open |\n| REQ-007 | Event Calendar Query API | GET /events with groupId, startDate, endDate returns filtered event list within 2 seconds<br>Calendar view includes event title, startTime, endTime, attendees, tags<br>Query supports role-based filtering, returns only events matching selected role | [REQ-006] | App | open |\n| REQ-008 | Event Detail and Update API | GET /events/{eventId} returns full event details including recurrence, tags, attendees, linked alerts<br>PUT /events/{eventId} updates event fields, prompts this-only vs all-future for recurring events<br>DELETE /events/{eventId} soft-deletes event or series based on scope parameter | [REQ-006] | App | open |\n| REQ-009 | Join-Request Alert Creation | POST /alerts/join-request creates alert with eventId, recipientIds, message, publishes to Kafka<br>Alert record persists in Postgres with type join-request, senderId, timestamp<br>Kafka message consumed by Notification Service within 5 seconds | [REQ-006] | App | open |\n| REQ-010 | Join-Request Response Handling | POST /alerts/{alertId}/respond accepts yes or no response, creates EventAttendee if yes<br>Response updates AlertRecipient record with response and respondedAt timestamp<br>Sender sees updated attendee list within 10 seconds via WebSocket or polling | [REQ-009] | App | open |\n| REQ-011 | Delay Alert Creation | POST /alerts/delay creates standalone or event-linked delay alert with priority flag<br>Alert publishes to Kafka delay-alerts or priority-alerts topic based on priority<br>Alert record includes senderId, eventId nullable, message, priority boolean | [REQ-006] | App | open |\n| REQ-012 | Push Notification Delivery | Notification Service consumes Kafka alerts, resolves FCM or APNS tokens from Postgres<br>Push notifications delivered within 5 seconds of Kafka publish, retries 3 times on failure<br>Notification payload includes type, alertId, eventId, senderId for deep linking | [REQ-009, REQ-011] | App | open |\n| REQ-013 | WebSocket Real-Time Updates | API Gateway manages WebSocket connections, handles subscribe and unsubscribe messages<br>Server publishes event.created, event.updated, alert.received to subscribed clients<br>WebSocket fallback to 30-second polling if connection drops for over 30 seconds | [REQ-006, REQ-009] | App | open |\n| REQ-014 | Role-Aware Calendar Filtering | Calendar view supports filter by role or individual member, persists across sessions<br>Filter updates calendar and alert list within 2 seconds, all-roles option resets filter<br>Filtered query uses role join on GroupMember and EventAttendee tables | [REQ-007] | App | open |\n| REQ-015 | Visual Clock Dashboard | Home screen displays avatar-based clock showing current activity per member<br>Clock updates every 15 minutes or on manual refresh, displays free status if no event<br>Tapping avatar opens member day schedule with all events | [REQ-007] | App | open |\n| REQ-016 | Activity Feed Query | GET /alerts with groupId and userId returns chronological feed of alerts and responses<br>Feed filterable by member, date range, alert type, updates in real-time via WebSocket<br>Feed includes event details, sender avatar, timestamp, response status | [REQ-009, REQ-011] | App | open |\n| REQ-017 | Member Availability View | Calendar view shows occupancy intervals per member based on event start and end times<br>Availability updates within 3 seconds of event changes, helps identify conflicts<br>Busy or free status computed from EventAttendee and EventInstance tables | [REQ-007] | App | open |\n| REQ-018 | React Native Mobile Client | Mobile app implements registration, group creation, event CRUD, alert send and response<br>App uses SQLite for offline event caching read-only, syncs on network reconnect<br>Push notification tap opens relevant event or alert detail screen | [REQ-001, REQ-006, REQ-009] | App | open |\n| REQ-019 | React Web Dashboard | Web app implements all mobile features plus desktop-optimized calendar views<br>Web uses IndexedDB for session persistence, supports keyboard navigation<br>WCAG AA compliance with color contrast ratio 4.5:1, screen reader ARIA labels | [REQ-001, REQ-006, REQ-009] | App | open |\n| REQ-020 | OIDC Authentication Integration | Auth0 tenant configured with email and phone OTP flows, issues JWT tokens<br>API Gateway validates tokens on all requests, extracts userId, groupIds, role claims<br>Token refresh endpoint returns new access token using valid refresh token | [] | App | open |\n| REQ-021 | API Rate Limiting and Security | API Gateway enforces 100 requests per minute per user based on token<br>All endpoints validate JSON schema, reject malformed requests with 400 status<br>SQL injection prevention via parameterized queries, XSS sanitization on user content | [REQ-020] | App | open |\n| REQ-022 | Observability Stack Integration | OpenTelemetry collector aggregates traces from all services, propagates trace IDs to clients<br>Prometheus scrapes metrics for request rate, error rate, latency histograms P50 P95 P99<br>Sentry captures mobile and web client errors, crash reports, unhandled exceptions | [] | App | open |\n| REQ-023 | Kubernetes Deployment Configuration | Helm charts deploy 5 microservices with 2 replicas each, API Gateway LoadBalancer service<br>Postgres StatefulSet single instance, Kafka StatefulSet 3 brokers replication factor 2<br>CI/CD pipeline builds Docker images, runs tests, deploys to staging namespace | [] | Infra | open |\n| REQ-024 | Data Lifecycle and GDPR-Lite | User profiles and events retained 30 days post-pilot, PII hashed in logs SHA-256<br>Admin API endpoint /users/{userId}/delete triggers soft-delete, purges after 7 days<br>S3 lifecycle policy deletes avatars after 90 days if user inactive | [REQ-001, REQ-006] | App | open |\n\n### Acceptance — REQ-001\n- POST /api/v1/users/register endpoint accepts JSON payload with email or phone, OTP, name, role\n- Backend validates OTP via Auth0, creates User record in Postgres with hashed email/phone\n- Response includes userId UUID and JWT access token valid for 1 hour\n- Avatar upload via POST /api/v1/users/{userId}/avatar generates S3 presigned URL, stores avatarUrl in User record\n- Registration flow from app launch to profile completion measured under 5 minutes in pilot testing\n- OIDC token includes userId, role claims, validated by API Gateway on subsequent requests\n\n### Acceptance — REQ-002\n- GET /api/v1/users/{userId} returns 200 status with JSON payload containing name, email, phone, role, avatarUrl\n- PUT /api/v1/users/{userId} accepts partial updates for name, role, avatarFile multipart form data\n- Avatar upload triggers S3 PUT with server-side AES-256 encryption, updates User.avatarUrl within 5 seconds\n- Profile changes publish user.updated event to Kafka, consumed by Group Service to update member rosters\n- Avatar URL changes propagate to all group member lists within 10 seconds via WebSocket or polling\n- Endpoint enforces authorization: only token owner can update own profile\n\n### Acceptance — REQ-003\n- POST /api/v1/groups endpoint accepts JSON with name, optional iconFile multipart\n- Backend creates Group record with groupId UUID, sets adminUserId to authenticated user from token\n- Icon upload to S3 via presigned URL, stores iconUrl in Group record\n- Response includes groupId, name, iconUrl, adminUserId within 3 seconds P95 latency\n- Group creation publishes group.created event to Kafka for audit logging\n- Postgres foreign key constraint enforces adminUserId references valid User.userId\n\n### Acceptance — REQ-004\n- POST /api/v1/groups/{groupId}/invite generates 6-character alphanumeric invite code, unique per group\n- Invite record created in Postgres with inviteId, groupId, email or phone, role, status pending, expiresAt 7 days\n- Email or SMS sent via external provider within 1 minute, includes invite code and deep link to app\n- POST /api/v1/groups/{groupId}/accept validates invite code, checks expiry, creates GroupMember record\n- Accepted invite updates Invite.status to accepted, publishes group.member_added to Kafka\n- New member appears in GET /api/v1/groups/{groupId} response within 10 seconds, WebSocket event sent to all group members\n\n### Acceptance — REQ-005\n- GET /api/v1/groups/{groupId} returns JSON array of members with userId, name, role, avatarUrl\n- DELETE /api/v1/groups/{groupId}/members/{userId} enforces RBAC: only adminUserId can remove members\n- Member removal deletes GroupMember record, publishes group.member_removed to Kafka\n- Removed member loses access to group events and alerts, enforced by API Gateway token validation\n- Member removal propagates to all shared calendars within 10 seconds via WebSocket\n- Endpoint returns 403 Forbidden if non-admin attempts removal, 404 if member not found\n\n### Acceptance — REQ-006\n- POST /api/v1/events accepts JSON with groupId, title, startTime, endTime, recurrence object, tags array, attendeeIds array\n- Backend creates Event record with eventId UUID, creatorUserId from token, recurrence JSON stored in Postgres\n- Recurring events generate EventInstance records for next 30 days based on recurrence pattern\n- Event creation publishes event.created to Kafka join-request-alerts topic within 500ms P95\n- EventAttendee records created for each attendeeId, foreign keys validated against GroupMember\n- Response includes eventId, array of instanceIds with startTime and endTime\n\n### Acceptance — REQ-007\n- GET /api/v1/events accepts query params groupId, startDate, endDate, returns filtered event list\n- Query joins Event, EventInstance, EventAttendee, User tables, filters by date range\n- Response includes event title, startTime, endTime, attendees array with name and avatarUrl, tags array\n- Role-based filtering via optional role query param, filters attendees by GroupMember.role\n- Query executes within 2 seconds P95 latency for 100 events, uses Postgres indexes on startTime and groupId\n- Pagination supported via limit and offset params, default limit 50 events\n\n### Acceptance — REQ-008\n- GET /api/v1/events/{eventId} returns full event details including recurrence JSON, tags, attendees, linked alerts\n- PUT /api/v1/events/{eventId} accepts partial updates for title, startTime, endTime, attendeeIds\n- Recurring event updates prompt scope parameter: this for single instance, future for all future instances\n- DELETE /api/v1/events/{eventId} soft-deletes event by setting Event.deleted true, scope param controls series deletion\n- Event updates publish event.updated to Kafka with changes object, consumed by clients for real-time refresh\n- Endpoint enforces authorization: only creatorUserId or group admin can update or delete event\n\n### Acceptance — REQ-009\n- POST /api/v1/alerts/join-request accepts JSON with eventId, recipientIds array, optional message\n- Backend creates Alert record with alertId UUID, type join-request, senderId from token, timestamp\n- AlertRecipient records created for each recipientId with response pending\n- Alert publishes to Kafka join-request-alerts topic with schema alertId, eventId, senderId, recipientIds, message, timestamp\n- Kafka message consumed by Notification Service within 5 seconds, triggers push notification send\n- Response includes alertId, returns 201 Created status\n\n### Acceptance — REQ-010\n- POST /api/v1/alerts/{alertId}/respond accepts JSON with response yes or no\n- Backend updates AlertRecipient record with response and respondedAt timestamp\n- If response yes, creates EventAttendee record linking userId to eventId\n- Response publishes alert.responded to Kafka with alertId, responderId, response\n- Sender sees updated attendee list via GET /api/v1/events/{eventId} within 10 seconds\n- Endpoint enforces authorization: only alert recipient can respond\n\n### Acceptance — REQ-011\n- POST /api/v1/alerts/delay accepts JSON with optional eventId, message, priority boolean\n- Backend creates Alert record with type delay or priority based on priority flag\n- Alert publishes to Kafka delay-alerts or priority-alerts topic based on priority\n- Priority alerts trigger full-screen modal on recipient app open, requires acknowledge tap\n- Standalone alerts appear in activity feed, event-linked alerts update event detail page with delay note\n- Response includes alertId, returns 201 Created status\n\n### Acceptance — REQ-012\n- Notification Service consumes Kafka alerts from join-request-alerts, delay-alerts, priority-alerts topics\n- Service queries PushToken table for recipient FCM or APNS tokens based on platform\n- Push notifications sent via FCM or APNS APIs within 5 seconds of Kafka message consumption\n- Notification payload includes type, alertId, eventId, senderId for deep linking to event or alert detail\n- Failed sends retry 3 times with exponential backoff, log failure to ELK stack after final retry\n- Notification delivery tracked via Prometheus metric notification_delivery_latency_seconds\n\n### Acceptance — REQ-013\n- API Gateway manages WebSocket connections on /ws endpoint, validates OIDC token on connect\n- Client sends subscribe message with groupId, server adds connection to group subscription map\n- Server publishes event.created, event.updated, event.deleted, alert.received to subscribed clients\n- WebSocket messages include payload with eventId or alertId, timestamp, sender details\n- If WebSocket connection drops for over 30 seconds, client falls back to 30-second polling on REST endpoints\n- Keepalive ping-pong every 60 seconds, server closes idle connections after 5 minutes\n\n### Acceptance — REQ-014\n- Calendar view includes filter dropdown with options: all roles, grandparent, parent, child, teen, other, individual members\n- Filter selection persists in client-side storage IndexedDB or SQLite, restored on app relaunch\n- Filtered query adds WHERE clause on GroupMember.role or EventAttendee.userId\n- Calendar and alert list update within 2 seconds of filter change, uses cached data if available\n- All-roles option removes filter, returns full event list for groupId\n- Filter state synced across mobile and web clients via user preferences API endpoint\n\n### Acceptance — REQ-015\n- Home screen displays circular clock with 5 avatar positions, one per family member\n- Clock queries current time, fetches events with startTime <= now and endTime >= now\n- Avatar positioned at clock hour corresponding to event startTime, displays event title on tap\n- Clock updates every 15 minutes via background timer, manual refresh via pull-to-refresh gesture\n- Free status displayed if no current event, avatar positioned at 12 o\\'clock with \"Free\" label\n- Tapping avatar opens member day schedule with all events in chronological list\n\n### Acceptance — REQ-016\n- GET /api/v1/alerts accepts query params groupId, userId, returns chronological feed of alerts\n- Feed includes join-request, delay, priority alerts with sender name, avatarUrl, message, timestamp\n- Feed filterable by member via userId param, date range via startDate and endDate params, alert type via type param\n- Real-time updates via WebSocket alert.received event, appends new alert to feed without full refresh\n- Feed pagination via limit and offset params, default limit 50 alerts\n- Response includes alert responses array with responderId, response, respondedAt for join-requests\n\n### Acceptance — REQ-017\n- Calendar view includes availability row per member, displays busy or free intervals\n- Availability computed from EventAttendee join with EventInstance, groups overlapping events\n- Busy intervals displayed as colored blocks on timeline, free intervals as white space\n- Availability updates within 3 seconds of event creation, update, or deletion via WebSocket\n- Conflict detection highlights overlapping events in red, suggests alternative times\n- Availability query uses Postgres window functions for efficient interval computation\n\n### Acceptance — REQ-018\n- React Native app implements user registration, profile management, group creation, event CRUD, alert send and response\n- App uses SQLite for offline event caching, syncs on network reconnect via background job\n- Push notification registration on app install, stores FCM or APNS token in PushToken table\n- Notification tap deep links to event detail or alert detail screen via React Navigation\n- App supports iOS 15+ and Android 12+, tested on iPhone 12 and Pixel 6\n- App distributed via TestFlight for iOS and internal Android track, no App Store approval required for pilot\n\n### Acceptance — REQ-019\n- React web app implements all mobile features: registration, group, event, alert workflows\n- Web uses IndexedDB for session persistence, stores auth token and user preferences\n- Desktop-optimized calendar views: monthly grid, weekly timeline, daily list\n- Keyboard navigation supported: Tab for focus, Enter for action, Escape for cancel\n- WCAG AA compliance: color contrast ratio 4.5:1, ARIA labels on all interactive elements, screen reader tested with NVDA\n- Web app tested on Chrome 120+, Safari 17+, Edge 120+, responsive design for 1024px+ viewports\n\n### Acceptance — REQ-020\n- Auth0 tenant configured with email and phone passwordless OTP flows\n- JWT tokens issued with 1-hour expiry, include userId, groupIds array, role claims\n- API Gateway validates token signature using Auth0 public key, checks expiry\n- Token refresh endpoint POST /oauth/token accepts refresh token, returns new access token\n- Refresh tokens valid for 7 days, stored securely in mobile keychain or web secure cookie\n- Token validation failure returns 401 Unauthorized, client redirects to login screen\n\n### Acceptance — REQ-021\n- API Gateway enforces rate limit 100 requests per minute per userId extracted from token\n- Rate limit exceeded returns 429 Too Many Requests with Retry-After header\n- All endpoints validate JSON schema using Joi or Yup, reject malformed requests with 400 Bad Request\n- SQL injection prevention via parameterized queries in all Postgres interactions\n- XSS sanitization on user-generated content: event titles, messages, group names using DOMPurify\n- CSRF protection via SameSite cookie attribute and CORS whitelist for web clients\n\n### Acceptance — REQ-022\n- OpenTelemetry SDK integrated in all Node.js services, exports traces to collector\n- Trace IDs propagated to mobile and web clients via X-Trace-Id response header\n- Prometheus metrics exposed on /metrics endpoint: http_requests_total, http_request_duration_seconds, kafka_messages_consumed_total\n- Grafana dashboards display P50, P95, P99 latency histograms, error rate by endpoint, Kafka lag\n- Sentry SDK integrated in React Native and React web apps, captures unhandled exceptions and crash reports\n- PagerDuty alerts configured: P95 latency > 1s, error rate > 5%, Kafka lag > 5 minutes\n\n### Acceptance — REQ-023\n- Helm charts define Deployments for User, Group, Event, Alert, Notification services with 2 replicas each\n- API Gateway Deployment with 2 replicas, exposes LoadBalancer service on port 443\n- Postgres StatefulSet with single instance, 10 GB persistent volume, 100 connection limit\n- Kafka StatefulSet with 3 brokers, replication factor 2, 10 topics pre-created\n- CI/CD pipeline in GitHub Actions: build Docker images, run unit and integration tests, deploy to staging namespace\n- Deployment rollout strategy: rolling update with maxUnavailable 1, readiness probe on /health endpoint\n\n### Acceptance — REQ-024\n- User profiles and events soft-deleted after 30 days post-pilot, deleted flag set true\n- PII fields email and phone hashed with SHA-256 in application logs, raw values not logged\n- Admin API endpoint DELETE /api/v1/users/{userId}/delete triggers soft-delete, schedules purge job after 7 days\n- Purge job deletes User, Event, Alert, PushToken records, removes avatars from S3\n- S3 lifecycle policy configured: delete objects with tag inactive=true after 90 days\n- GDPR-lite consent: push notification opt-in on first launch, privacy policy and ToS displayed during registration\n\n## Dependency Graph (textual)\n- REQ-001 → (no dependencies)\n- REQ-002 → REQ-001\n- REQ-003 → REQ-001\n- REQ-004 → REQ-003\n- REQ-005 → REQ-003, REQ-004\n- REQ-006 → REQ-003\n- REQ-007 → REQ-006\n- REQ-008 → REQ-006\n- REQ-009 → REQ-006\n- REQ-010 → REQ-009\n- REQ-011 → REQ-006\n- REQ-012 → REQ-009, REQ-011\n- REQ-013 → REQ-006, REQ-009\n- REQ-014 → REQ-007\n- REQ-015 → REQ-007\n- REQ-016 → REQ-009, REQ-011\n- REQ-017 → REQ-007\n- REQ-018 → REQ-001, REQ-006, REQ-009\n- REQ-019 → REQ-001, REQ-006, REQ-009\n- REQ-020 → (no dependencies)\n- REQ-021 → REQ-020\n- REQ-022 → (no dependencies)\n- REQ-023 → (no dependencies)\n- REQ-024 → REQ-001, REQ-006\n\n## Iteration Strategy\n- **Batch 1 (Days 1-3):** REQ-001, REQ-020, REQ-022, REQ-023 — Foundation (auth, observability, infra). Estimation: S (REQ-001, REQ-020), M (REQ-022, REQ-023). Confidence: ±0 batches (critical path).\n- **Batch 2 (Days 4-6):** REQ-002, REQ-003, REQ-004, REQ-005 — User and group management. Estimation: S (REQ-002, REQ-004), M (REQ-003, REQ-005). Confidence: ±1 batch (depends on Auth0 setup).\n- **Batch 3 (Days 7-9):** REQ-006, REQ-007, REQ-008 — Event CRUD and calendar. Estimation: M (REQ-006, REQ-007), S (REQ-008). Confidence: ±1 batch (recurring events complexity).\n- **Batch 4 (Days 10-12):** REQ-009, REQ-010, REQ-011, REQ-012, REQ-013 — Alerts and real-time. Estimation: S (REQ-009, REQ-010, REQ-011), M (REQ-012, REQ-013). Confidence: ±1 batch (Kafka and push notification setup).\n- **Batch 5 (Days 13-14):** REQ-014, REQ-015, REQ-016, REQ-017, REQ-018, REQ-019, REQ-021, REQ-024 — UI features, security, data lifecycle. Estimation: S (REQ-014, REQ-015, REQ-016, REQ-017, REQ-021, REQ-024), L (REQ-018, REQ-019). Confidence: ±1 batch (mobile and web client integration).\n\n## Test Strategy\n- **Per REQ:** Unit tests for all API endpoints (80% coverage target), integration tests for Kafka producers/consumers, E2E tests for critical flows (registration, event creation, alert send).\n- **Per Batch:** Batch 1 validates auth token issuance and validation, observability trace propagation, Kubernetes deployment health checks. Batch 2 validates group creation and member management workflows. Batch 3 validates event CRUD and recurring event generation. Batch 4 validates alert delivery and WebSocket real-time updates. Batch 5 validates mobile and web client UI, security rate limiting, data lifecycle purge jobs.\n- **Load Testing:** 50 concurrent users, 1,000 API calls over 10 minutes, validate P95 latency ≤500ms and error rate ≤5%.\n- **Security Testing:** OWASP ZAP scan for SQL injection, XSS, CSRF vulnerabilities. Dependency scanning via npm audit and Snyk.\n- **Accessibility Testing:** WCAG AA compliance validation using axe-core, screen reader testing with NVDA and VoiceOver.\n\n## KIT Readiness (per REQ)\n- **REQ-001:** `/runs/kit/REQ-001/src` contains user registration API handler, OTP validation logic, Postgres User table insert. `/runs/kit/REQ-001/test` contains unit tests for registration endpoint, integration test for Auth0 OTP flow. Commands: `npm test`, `npm run lint`. Expected: all tests pass, 80% coverage. KIT-functional: yes.\n- **REQ-002:** `/runs/kit/REQ-002/src` contains profile GET/PUT handlers, S3 presigned URL generation. `/runs/kit/REQ-002/test` contains unit tests for profile endpoints, integration test for avatar upload. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-003:** `/runs/kit/REQ-003/src` contains group creation API handler, Postgres Group table insert. `/runs/kit/REQ-003/test` contains unit tests for group creation, integration test for icon upload. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-004:** `/runs/kit/REQ-004/src` contains invite generation and acceptance handlers, email/SMS send logic. `/runs/kit/REQ-004/test` contains unit tests for invite endpoints, integration test for invite code validation. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-005:** `/runs/kit/REQ-005/src` contains group member list and removal handlers, RBAC enforcement. `/runs/kit/REQ-005/test` contains unit tests for member management, integration test for admin authorization. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-006:** `/runs/kit/REQ-006/src` contains event creation handler, recurring event instance generation, Kafka publish logic. `/runs/kit/REQ-006/test` contains unit tests for event creation, integration test for Kafka message. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-007:** `/runs/kit/REQ-007/src` contains event query handler, role-based filtering logic. `/runs/kit/REQ-007/test` contains unit tests for event query, integration test for date range filtering. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-008:** `/runs/kit/REQ-008/src` contains event detail, update, delete handlers, recurring event scope logic. `/runs/kit/REQ-008/test` contains unit tests for event endpoints, integration test for soft-delete. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-009:** `/runs/kit/REQ-009/src` contains join-request alert creation handler, Kafka publish logic. `/runs/kit/REQ-009/test` contains unit tests for alert creation, integration test for Kafka message. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-010:** `/runs/kit/REQ-010/src` contains join-request response handler, EventAttendee creation logic. `/runs/kit/REQ-010/test` contains unit tests for response endpoint, integration test for attendee link. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-011:** `/runs/kit/REQ-011/src` contains delay alert creation handler, priority flag logic, Kafka publish. `/runs/kit/REQ-011/test` contains unit tests for delay alert, integration test for priority topic. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-012:** `/runs/kit/REQ-012/src` contains Notification Service Kafka consumer, FCM/APNS send logic, retry mechanism. `/runs/kit/REQ-012/test` contains unit tests for notification send, integration test for Kafka consumption. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-013:** `/runs/kit/REQ-013/src` contains WebSocket connection handler, subscribe/unsubscribe logic, event publish. `/runs/kit/REQ-013/test` contains unit tests for WebSocket messages, integration test for real-time updates. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-014:** `/runs/kit/REQ-014/src` contains calendar filter logic, role-based query builder. `/runs/kit/REQ-014/test` contains unit tests for filter logic, integration test for filtered query. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-015:** `/runs/kit/REQ-015/src` contains clock dashboard query logic, current event resolver. `/runs/kit/REQ-015/test` contains unit tests for clock logic, integration test for avatar positioning. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-016:** `/runs/kit/REQ-016/src` contains activity feed query handler, filter logic. `/runs/kit/REQ-016/test` contains unit tests for feed query, integration test for real-time updates. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-017:** `/runs/kit/REQ-017/src` contains availability query logic, interval computation. `/runs/kit/REQ-017/test` contains unit tests for availability logic, integration test for conflict detection. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-018:** `/runs/kit/REQ-018/src` contains React Native app screens, SQLite offline cache, push notification handler. `/runs/kit/REQ-018/test` contains unit tests for components, E2E tests for critical flows. Commands: `npm test`, `detox test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-019:** `/runs/kit/REQ-019/src` contains React web app components, IndexedDB session storage, keyboard navigation. `/runs/kit/REQ-019/test` contains unit tests for components, E2E tests for critical flows, axe-core accessibility tests. Commands: `npm test`, `npm run test:e2e`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-020:** `/runs/kit/REQ-020/src` contains Auth0 tenant configuration, token validation middleware. `/runs/kit/REQ-020/test` contains unit tests for token validation, integration test for Auth0 OTP flow. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-021:** `/runs/kit/REQ-021/src` contains rate limiting middleware, JSON schema validation, SQL injection prevention. `/runs/kit/REQ-021/test` contains unit tests for security middleware, integration test for rate limit enforcement. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-022:** `/runs/kit/REQ-022/src` contains OpenTelemetry SDK setup, Prometheus metrics exporter, Sentry SDK integration. `/runs/kit/REQ-022/test` contains unit tests for observability setup, integration test for trace propagation. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n- **REQ-023:** `/runs/kit/REQ-023/src` contains Helm charts for all services, CI/CD pipeline configuration. `/runs/kit/REQ-023/test` contains Helm chart validation, deployment smoke tests. Commands: `helm lint`, `kubectl apply --dry-run`. Expected: all charts valid. KIT-functional: yes.\n- **REQ-024:** `/runs/kit/REQ-024/src` contains data lifecycle purge job, GDPR-lite delete endpoint. `/runs/kit/REQ-024/test` contains unit tests for purge logic, integration test for soft-delete and S3 cleanup. Commands: `npm test`. Expected: all tests pass. KIT-functional: yes.\n\n## Notes\n- **Assumptions:** Auth0 tenant setup completed before Batch 1. Kafka cluster and Postgres database available in staging namespace before Batch 1. S3-compatible storage (AWS S3 or MinIO) configured with lifecycle policies. FCM and APNS credentials obtained for push notification testing.\n- **Risks & Mitigations:** \n  - Risk: Recurring event generation complexity may delay Batch 3. Mitigation: Implement simple daily/weekly patterns first, defer monthly to post-pilot if needed.\n  - Risk: WebSocket connection stability on mobile networks. Mitigation: Implement 30-second polling fallback, test on 3G/4G networks during pilot.\n  - Risk: Push notification delivery latency >5s. Mitigation: Monitor Kafka lag and FCM/APNS response times, add retry logic with exponential backoff.\n  - Risk: WCAG AA compliance validation may require UI redesign. Mitigation: Use high-contrast color palette from start, test with screen readers early in Batch 5.\n- **Lane Detection:** Detected lanes: `node` (backend services), `sql` (Postgres), `kafka` (messaging), `ci` (GitHub Actions), `infra` (Kubernetes). Lane-guides emitted for each."
      },
      {
         "path":"docs/harper/plan.json",
         "content":"{\n  \"snapshot\": {\n    \"total\": 24,\n    \"open\": 24,\n    \"in_progress\": 0,\n    \"done\": 0,\n    \"deferred\": 0,\n    \"progressPct\": 0\n  },\n  \"reqs\": [\n    {\n      \"id\": \"REQ-001\",\n      \"title\": \"User Registration API\",\n      \"acceptance\": [\n        \"POST /users/register accepts email or phone with OTP, returns userId and JWT token\",\n        \"Profile creation includes name, role dropdown, avatar upload to S3 via presigned URL\",\n        \"Registration flow completes in under 5 minutes with valid OIDC token issued\",\n        \"Backend validates OTP via Auth0, creates User record in Postgres with hashed email/phone\",\n        \"Response includes userId UUID and JWT access token valid for 1 hour\",\n        \"OIDC token includes userId, role claims, validated by API Gateway on subsequent requests\"\n      ],\n      \"dependsOn\": [],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration_e2e\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-002\",\n      \"title\": \"User Profile Management API\",\n      \"acceptance\": [\n        \"GET /users/{userId} returns profile with name, email, phone, role, avatarUrl\",\n        \"PUT /users/{userId} updates profile fields, avatar upload generates new S3 URL\",\n        \"Avatar changes propagate to all group rosters within 10 seconds\",\n        \"Avatar upload triggers S3 PUT with server-side AES-256 encryption, updates User.avatarUrl within 5 seconds\",\n        \"Profile changes publish user.updated event to Kafka, consumed by Group Service to update member rosters\",\n        \"Endpoint enforces authorization: only token owner can update own profile\"\n      ],\n      \"dependsOn\": [\"REQ-001\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-003\",\n      \"title\": \"Family Group Creation API\",\n      \"acceptance\": [\n        \"POST /groups creates group with name, icon, sets adminUserId to founder\",\n        \"Group creation returns groupId, iconUrl, admin details within 3 seconds\",\n        \"Group record persists in Postgres with correct foreign key to User\",\n        \"Icon upload to S3 via presigned URL, stores iconUrl in Group record\",\n        \"Group creation publishes group.created event to Kafka for audit logging\",\n        \"Postgres foreign key constraint enforces adminUserId references valid User.userId\"\n      ],\n      \"dependsOn\": [\"REQ-001\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-004\",\n      \"title\": \"Group Invitation Workflow\",\n      \"acceptance\": [\n        \"POST /groups/{groupId}/invite generates 6-char invite code, sends email or SMS within 1 minute\",\n        \"POST /groups/{groupId}/accept validates invite code, creates GroupMember record\",\n        \"Accepted member appears in group roster within 10 seconds via WebSocket event\",\n        \"Invite record created in Postgres with inviteId, groupId, email or phone, role, status pending, expiresAt 7 days\",\n        \"Email or SMS sent via external provider within 1 minute, includes invite code and deep link to app\",\n        \"Accepted invite updates Invite.status to accepted, publishes group.member_added to Kafka\"\n      ],\n      \"dependsOn\": [\"REQ-003\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-005\",\n      \"title\": \"Group Member Management\",\n      \"acceptance\": [\n        \"GET /groups/{groupId} returns member list with userId, name, role, avatarUrl\",\n        \"DELETE /groups/{groupId}/members/{userId} removes member, admin-only authorization enforced\",\n        \"Member removal propagates to all shared calendars immediately\",\n        \"Member removal deletes GroupMember record, publishes group.member_removed to Kafka\",\n        \"Removed member loses access to group events and alerts, enforced by API Gateway token validation\",\n        \"Endpoint returns 403 Forbidden if non-admin attempts removal, 404 if member not found\"\n      ],\n      \"dependsOn\": [\"REQ-003\", \"REQ-004\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-006\",\n      \"title\": \"Event Creation API\",\n      \"acceptance\": [\n        \"POST /events creates event with title, startTime, endTime, recurrence, tags, attendeeIds\",\n        \"Recurring events generate instances for next 30 days, stored in EventInstance table\",\n        \"Event creation publishes event.created to Kafka within 500ms\",\n        \"Backend creates Event record with eventId UUID, creatorUserId from token, recurrence JSON stored in Postgres\",\n        \"EventAttendee records created for each attendeeId, foreign keys validated against GroupMember\",\n        \"Response includes eventId, array of instanceIds with startTime and endTime\"\n      ],\n      \"dependsOn\": [\"REQ-003\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-007\",\n      \"title\": \"Event Calendar Query API\",\n      \"acceptance\": [\n        \"GET /events with groupId, startDate, endDate returns filtered event list within 2 seconds\",\n        \"Calendar view includes event title, startTime, endTime, attendees, tags\",\n        \"Query supports role-based filtering, returns only events matching selected role\",\n        \"Query joins Event, EventInstance, EventAttendee, User tables, filters by date range\",\n        \"Query executes within 2 seconds P95 latency for 100 events, uses Postgres indexes on startTime and groupId\",\n        \"Pagination supported via limit and offset params, default limit 50 events\"\n      ],\n      \"dependsOn\": [\"REQ-006\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-008\",\n      \"title\": \"Event Detail and Update API\",\n      \"acceptance\": [\n        \"GET /events/{eventId} returns full event details including recurrence, tags, attendees, linked alerts\",\n        \"PUT /events/{eventId} updates event fields, prompts this-only vs all-future for recurring events\",\n        \"DELETE /events/{eventId} soft-deletes event or series based on scope parameter\",\n        \"Recurring event updates prompt scope parameter: this for single instance, future for all future instances\",\n        \"Event updates publish event.updated to Kafka with changes object, consumed by clients for real-time refresh\",\n        \"Endpoint enforces authorization: only creatorUserId or group admin can update or delete event\"\n      ],\n      \"dependsOn\": [\"REQ-006\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-009\",\n      \"title\": \"Join-Request Alert Creation\",\n      \"acceptance\": [\n        \"POST /alerts/join-request creates alert with eventId, recipientIds, message, publishes to Kafka\",\n        \"Alert record persists in Postgres with type join-request, senderId, timestamp\",\n        \"Kafka message consumed by Notification Service within 5 seconds\",\n        \"Backend creates Alert record with alertId UUID, type join-request, senderId from token, timestamp\",\n        \"AlertRecipient records created for each recipientId with response pending\",\n        \"Response includes alertId, returns 201 Created status\"\n      ],\n      \"dependsOn\": [\"REQ-006\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-010\",\n      \"title\": \"Join-Request Response Handling\",\n      \"acceptance\": [\n        \"POST /alerts/{alertId}/respond accepts yes or no response, creates EventAttendee if yes\",\n        \"Response updates AlertRecipient record with response and respondedAt timestamp\",\n        \"Sender sees updated attendee list within 10 seconds via WebSocket or polling\",\n        \"If response yes, creates EventAttendee record linking userId to eventId\",\n        \"Response publishes alert.responded to Kafka with alertId, responderId, response\",\n        \"Endpoint enforces authorization: only alert recipient can respond\"\n      ],\n      \"dependsOn\": [\"REQ-009\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-011\",\n      \"title\": \"Delay Alert Creation\",\n      \"acceptance\": [\n        \"POST /alerts/delay creates standalone or event-linked delay alert with priority flag\",\n        \"Alert publishes to Kafka delay-alerts or priority-alerts topic based on priority\",\n        \"Alert record includes senderId, eventId nullable, message, priority boolean\",\n        \"Backend creates Alert record with type delay or priority based on priority flag\",\n        \"Priority alerts trigger full-screen modal on recipient app open, requires acknowledge tap\",\n        \"Response includes alertId, returns 201 Created status\"\n      ],\n      \"dependsOn\": [\"REQ-006\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-012\",\n      \"title\": \"Push Notification Delivery\",\n      \"acceptance\": [\n        \"Notification Service consumes Kafka alerts, resolves FCM or APNS tokens from Postgres\",\n        \"Push notifications delivered within 5 seconds of Kafka publish, retries 3 times on failure\",\n        \"Notification payload includes type, alertId, eventId, senderId for deep linking\",\n        \"Service queries PushToken table for recipient FCM or APNS tokens based on platform\",\n        \"Failed sends retry 3 times with exponential backoff, log failure to ELK stack after final retry\",\n        \"Notification delivery tracked via Prometheus metric notification_delivery_latency_seconds\"\n      ],\n      \"dependsOn\": [\"REQ-009\", \"REQ-011\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-013\",\n      \"title\": \"WebSocket Real-Time Updates\",\n      \"acceptance\": [\n        \"API Gateway manages WebSocket connections, handles subscribe and unsubscribe messages\",\n        \"Server publishes event.created, event.updated, alert.received to subscribed clients\",\n        \"WebSocket fallback to 30-second polling if connection drops for over 30 seconds\",\n        \"Client sends subscribe message with groupId, server adds connection to group subscription map\",\n        \"WebSocket messages include payload with eventId or alertId, timestamp, sender details\",\n        \"Keepalive ping-pong every 60 seconds, server closes idle connections after 5 minutes\"\n      ],\n      \"dependsOn\": [\"REQ-006\", \"REQ-009\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-014\",\n      \"title\": \"Role-Aware Calendar Filtering\",\n      \"acceptance\": [\n        \"Calendar view supports filter by role or individual member, persists across sessions\",\n        \"Filter updates calendar and alert list within 2 seconds, all-roles option resets filter\",\n        \"Filtered query uses role join on GroupMember and EventAttendee tables\",\n        \"Filter selection persists in client-side storage IndexedDB or SQLite, restored on app relaunch\",\n        \"Filtered query adds WHERE clause on GroupMember.role or EventAttendee.userId\",\n        \"Filter state synced across mobile and web clients via user preferences API endpoint\"\n      ],\n      \"dependsOn\": [\"REQ-007\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-015\",\n      \"title\": \"Visual Clock Dashboard\",\n      \"acceptance\": [\n        \"Home screen displays avatar-based clock showing current activity per member\",\n        \"Clock updates every 15 minutes or on manual refresh, displays free status if no event\",\n        \"Tapping avatar opens member day schedule with all events\",\n        \"Clock queries current time, fetches events with startTime <= now and endTime >= now\",\n        \"Avatar positioned at clock hour corresponding to event startTime, displays event title on tap\",\n        \"Free status displayed if no current event, avatar positioned at 12 o\\'clock with Free label\"\n      ],\n      \"dependsOn\": [\"REQ-007\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-016\",\n      \"title\": \"Activity Feed Query\",\n      \"acceptance\": [\n        \"GET /alerts with groupId and userId returns chronological feed of alerts and responses\",\n        \"Feed filterable by member, date range, alert type, updates in real-time via WebSocket\",\n        \"Feed includes event details, sender avatar, timestamp, response status\",\n        \"Feed includes join-request, delay, priority alerts with sender name, avatarUrl, message, timestamp\",\n        \"Feed pagination via limit and offset params, default limit 50 alerts\",\n        \"Response includes alert responses array with responderId, response, respondedAt for join-requests\"\n      ],\n      \"dependsOn\": [\"REQ-009\", \"REQ-011\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-017\",\n      \"title\": \"Member Availability View\",\n      \"acceptance\": [\n        \"Calendar view shows occupancy intervals per member based on event start and end times\",\n        \"Availability updates within 3 seconds of event changes, helps identify conflicts\",\n        \"Busy or free status computed from EventAttendee and EventInstance tables\",\n        \"Availability computed from EventAttendee join with EventInstance, groups overlapping events\",\n        \"Busy intervals displayed as colored blocks on timeline, free intervals as white space\",\n        \"Conflict detection highlights overlapping events in red, suggests alternative times\"\n      ],\n      \"dependsOn\": [\"REQ-007\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-018\",\n      \"title\": \"React Native Mobile Client\",\n      \"acceptance\": [\n        \"Mobile app implements registration, group creation, event CRUD, alert send and response\",\n        \"App uses SQLite for offline event caching, syncs on network reconnect\",\n        \"Push notification tap opens relevant event or alert detail screen\",\n        \"Push notification registration on app install, stores FCM or APNS token in PushToken table\",\n        \"App supports iOS 15+ and Android 12+, tested on iPhone 12 and Pixel 6\",\n        \"App distributed via TestFlight for iOS and internal Android track, no App Store approval required for pilot\"\n      ],\n      \"dependsOn\": [\"REQ-001\", \"REQ-006\", \"REQ-009\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_e2e\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-019\",\n      \"title\": \"React Web Dashboard\",\n      \"acceptance\": [\n        \"Web app implements all mobile features plus desktop-optimized calendar views\",\n        \"Web uses IndexedDB for session persistence, supports keyboard navigation\",\n        \"WCAG AA compliance with color contrast ratio 4.5:1, screen reader ARIA labels\",\n        \"Desktop-optimized calendar views: monthly grid, weekly timeline, daily list\",\n        \"Keyboard navigation supported: Tab for focus, Enter for action, Escape for cancel\",\n        \"Web app tested on Chrome 120+, Safari 17+, Edge 120+, responsive design for 1024px+ viewports\"\n      ],\n      \"dependsOn\": [\"REQ-001\", \"REQ-006\", \"REQ-009\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_e2e_accessibility\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-020\",\n      \"title\": \"OIDC Authentication Integration\",\n      \"acceptance\": [\n        \"Auth0 tenant configured with email and phone OTP flows, issues JWT tokens\",\n        \"API Gateway validates tokens on all requests, extracts userId, groupIds, role claims\",\n        \"Token refresh endpoint returns new access token using valid refresh token\",\n        \"JWT tokens issued with 1-hour expiry, include userId, groupIds array, role claims\",\n        \"Refresh tokens valid for 7 days, stored securely in mobile keychain or web secure cookie\",\n        \"Token validation failure returns 401 Unauthorized, client redirects to login screen\"\n      ],\n      \"dependsOn\": [],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-021\",\n      \"title\": \"API Rate Limiting and Security\",\n      \"acceptance\": [\n        \"API Gateway enforces 100 requests per minute per user based on token\",\n        \"All endpoints validate JSON schema, reject malformed requests with 400 status\",\n        \"SQL injection prevention via parameterized queries, XSS sanitization on user content\",\n        \"Rate limit exceeded returns 429 Too Many Requests with Retry-After header\",\n        \"SQL injection prevention via parameterized queries in all Postgres interactions\",\n        \"CSRF protection via SameSite cookie attribute and CORS whitelist for web clients\"\n      ],\n      \"dependsOn\": [\"REQ-020\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration_security\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-022\",\n      \"title\": \"Observability Stack Integration\",\n      \"acceptance\": [\n        \"OpenTelemetry collector aggregates traces from all services, propagates trace IDs to clients\",\n        \"Prometheus scrapes metrics for request rate, error rate, latency histograms P50 P95 P99\",\n        \"Sentry captures mobile and web client errors, crash reports, unhandled exceptions\",\n        \"Trace IDs propagated to mobile and web clients via X-Trace-Id response header\",\n        \"Grafana dashboards display P50, P95, P99 latency histograms, error rate by endpoint, Kafka lag\",\n        \"PagerDuty alerts configured: P95 latency > 1s, error rate > 5%, Kafka lag > 5 minutes\"\n      ],\n      \"dependsOn\": [],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    },\n    {\n      \"id\": \"REQ-023\",\n      \"title\": \"Kubernetes Deployment Configuration\",\n      \"acceptance\": [\n        \"Helm charts deploy 5 microservices with 2 replicas each, API Gateway LoadBalancer service\",\n        \"Postgres StatefulSet single instance, Kafka StatefulSet 3 brokers replication factor 2\",\n        \"CI/CD pipeline builds Docker images, runs tests, deploys to staging namespace\",\n        \"API Gateway Deployment with 2 replicas, exposes LoadBalancer service on port 443\",\n        \"Postgres StatefulSet with single instance, 10 GB persistent volume, 100 connection limit\",\n        \"Deployment rollout strategy: rolling update with maxUnavailable 1, readiness probe on /health endpoint\"\n      ],\n      \"dependsOn\": [],\n      \"track\": \"Infra\",\n      \"status\": \"open\",\n      \"lane\": \"infra\",\n      \"test_profile\": \"smoke_validation\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/infra.md\"\n    },\n    {\n      \"id\": \"REQ-024\",\n      \"title\": \"Data Lifecycle and GDPR-Lite\",\n      \"acceptance\": [\n        \"User profiles and events retained 30 days post-pilot, PII hashed in logs SHA-256\",\n        \"Admin API endpoint /users/{userId}/delete triggers soft-delete, purges after 7 days\",\n        \"S3 lifecycle policy deletes avatars after 90 days if user inactive\",\n        \"PII fields email and phone hashed with SHA-256 in application logs, raw values not logged\",\n        \"Purge job deletes User, Event, Alert, PushToken records, removes avatars from S3\",\n        \"GDPR-lite consent: push notification opt-in on first launch, privacy policy and ToS displayed during registration\"\n      ],\n      \"dependsOn\": [\"REQ-001\", \"REQ-006\"],\n      \"track\": \"App\",\n      \"status\": \"open\",\n      \"lane\": \"node\",\n      \"test_profile\": \"unit_integration\",\n      \"gate_policy_ref\": \"docs/harper/lane-guides/node.md\"\n    }\n  ]\n}"
      },
      {
         "path":"docs/harper/lane-guides/node.md",
         "content":"## Lane Guide — node\n\n### Tools\n- **tests:** Jest 29+ for unit and integration tests, Supertest for API endpoint testing, Detox for React Native E2E tests\n- **lint:** ESLint 8+ with Airbnb config, Prettier for code formatting\n- **types:** TypeScript 5+ with strict mode enabled, @types packages for Node.js and Express\n- **security:** npm audit for dependency scanning, Snyk for vulnerability monitoring, OWASP ZAP for API security testing\n- **build:** Webpack 5+ for bundling, Babel for transpilation, Docker for containerization\n\n### CLI Examples\n- **Local:**\n  - Run tests: `npm test` (runs Jest with coverage report)\n  - Lint code: `npm run lint` (runs ESLint and Prettier)\n  - Type check: `npm run type-check` (runs TypeScript compiler in no-emit mode)\n  - Security scan: `npm audit` (checks for known vulnerabilities in dependencies)\n  - Build: `npm run build` (compiles TypeScript to JavaScript, bundles with Webpack)\n- **Containerized:**\n  - Build image: `docker build -t family-frame-api:latest .`\n  - Run tests in container: `docker run --rm family-frame-api:latest npm test`\n  - Run security scan: `docker run --rm family-frame-api:latest npm audit`\n  - Deploy to Kubernetes: `kubectl apply -f k8s/deployment.yaml`\n\n### Default Gate Policy\n- **min coverage:** 80% line coverage, 75% branch coverage (measured by Jest)\n- **max criticals:** 0 critical vulnerabilities in npm audit, 0 high-severity issues in Snyk\n- **lint:** 0 ESLint errors, warnings allowed but must be justified in PR description\n- **type safety:** 0 TypeScript errors, strict mode enabled\n- **performance:** P95 API latency ≤500ms, P99 ≤1s (measured by Prometheus)\n- **security:** OWASP ZAP scan passes with 0 high-risk vulnerabilities\n\n### Enterprise Runner Notes\n- **SonarQube:** Integrate SonarQube scanner in CI/CD pipeline for code quality analysis. Configure quality gate: coverage ≥80%, duplications ≤3%, maintainability rating A. SonarQube server URL and token stored in GitHub Secrets.\n- **Jenkins:** Jenkins pipeline stages: checkout, install dependencies, run tests, lint, security scan, build Docker image, push to registry, deploy to Kubernetes. Use Jenkins shared libraries for reusable pipeline steps. Artifacts stored in Artifactory or Nexus.\n- **GitLab CI:** GitLab CI/CD pipeline defined in `.gitlab-ci.yml`. Stages: test, lint, security, build, deploy. Use GitLab Container Registry for Docker images. Secrets managed via GitLab CI/CD variables.\n- **Azure DevOps:** Azure Pipelines YAML configuration for multi-stage pipeline. Stages: build, test, security scan, publish artifacts, deploy to AKS. Use Azure Key Vault for secrets management.\n\n### TECH_CONSTRAINTS integration\n- **air-gap:** For air-gapped environments, pre-download npm packages and Docker base images. Use Verdaccio or Artifactory as internal npm registry. Configure `.npmrc` to point to internal registry. Docker images pulled from internal registry (e.g., Harbor).\n- **registries:** Configure Docker daemon to use internal registry (e.g., `registry.internal.company.com`). Update Kubernetes image pull secrets to authenticate with internal registry. Use `npm config set registry` to point to internal npm registry.\n- **tokens:** Store Auth0 client ID and secret in Kubernetes Secrets. Use environment variables to inject secrets into containers. Rotate tokens every 90 days. Use HashiCorp Vault for centralized secrets management if available."
      },
      {
         "path":"docs/harper/lane-guides/sql.md",
         "content":"## Lane Guide — sql\n\n### Tools\n- **tests:** pgTAP for database unit tests, Liquibase or Flyway for schema migration testing\n- **lint:** sqlfluff for SQL linting, pg_format for SQL formatting\n- **types:** Postgres native types, enforce constraints via CHECK and FOREIGN KEY\n- **security:** pg_audit for audit logging, pgcrypto for PII encryption, SSL/TLS for connections\n- **build:** Liquibase or Flyway for schema versioning and migration, pg_dump for backups\n\n### CLI Examples\n- **Local:**\n  - Run migrations: `liquibase update` or `flyway migrate`\n  - Run tests: `pg_prove -d family_frame test/*.sql` (pgTAP tests)\n  - Lint SQL: `sqlfluff lint migrations/*.sql`\n  - Format SQL: `pg_format -i migrations/*.sql`\n  - Backup database: `pg_dump -U postgres -d family_frame > backup.sql`\n- **Containerized:**\n  - Run Postgres in Docker: `docker run -d -p 5432:5432 -e POSTGRES_PASSWORD=secret postgres:15`\n  - Run migrations in container: `docker run --rm -v $(pwd)/migrations:/migrations liquibase/liquibase update`\n  - Run tests in container: `docker run --rm -v $(pwd)/test:/test postgres:15 pg_prove -d family_frame /test/*.sql`\n\n### Default Gate Policy\n- **min coverage:** 100% of tables have at least one pgTAP test, 80% of stored procedures tested\n- **max criticals:** 0 missing foreign key constraints, 0 unindexed foreign keys, 0 tables without primary keys\n- **lint:** 0 sqlfluff errors, warnings allowed for legacy code\n- **security:** All PII columns encrypted with pgcrypto, SSL/TLS enforced for all connections, pg_audit enabled for all DDL and DML operations\n- **performance:** All queries in critical paths have EXPLAIN ANALYZE plans reviewed, indexes on all foreign keys and frequently queried columns\n\n### Enterprise Runner Notes\n- **SonarQube:** SonarQube does not natively support SQL, but custom rules can be added via SonarQube plugins. Use sqlfluff output as input to SonarQube for SQL quality metrics.\n- **Jenkins:** Jenkins pipeline stages: checkout, run Liquibase migrations, run pgTAP tests, lint SQL, backup database. Use Jenkins credentials plugin for Postgres credentials. Store migration scripts in Git, apply migrations in staging before production.\n- **GitLab CI:** GitLab CI/CD pipeline defined in `.gitlab-ci.yml`. Stages: migrate, test, lint. Use GitLab CI/CD variables for Postgres connection strings. Run migrations in staging environment before production.\n- **Azure DevOps:** Azure Pipelines YAML configuration for database deployment. Stages: migrate, test, backup. Use Azure Key Vault for Postgres credentials. Deploy migrations to Azure Database for PostgreSQL.\n\n### TECH_CONSTRAINTS integration\n- **air-gap:** For air-gapped environments, pre-download Postgres Docker images and Liquibase/Flyway binaries. Store migration scripts in internal Git repository. Use internal artifact repository for Liquibase/Flyway dependencies.\n- **registries:** Configure Postgres Docker image to pull from internal registry (e.g., `registry.internal.company.com/postgres:15`). Update Kubernetes StatefulSet to use internal registry for Postgres image.\n- **tokens:** Store Postgres credentials in Kubernetes Secrets. Use environment variables to inject credentials into migration jobs. Rotate Postgres passwords every 90 days. Use HashiCorp Vault for centralized secrets management if available."
      },
      {
         "path":"docs/harper/lane-guides/kafka.md",
         "content":"## Lane Guide — kafka\n\n### Tools\n- **tests:** Testcontainers for Kafka integration tests, KafkaJS for Node.js Kafka client testing\n- **lint:** No standard linter for Kafka configuration, use YAML linters for topic configuration files\n- **types:** Avro or JSON Schema for message schema validation, Schema Registry for schema versioning\n- **security:** SASL/SCRAM for authentication, SSL/TLS for encryption, ACLs for authorization\n- **build:** Kafka CLI tools for topic creation and management, Helm charts for Kafka deployment\n\n### CLI Examples\n- **Local:**\n  - Start Kafka: `docker-compose up -d` (using docker-compose.yml with Kafka and Zookeeper)\n  - Create topic: `kafka-topics.sh --create --topic join-request-alerts --bootstrap-server localhost:9092 --partitions 3 --replication-factor 2`\n  - Produce message: `kafka-console-producer.sh --topic join-request-alerts --bootstrap-server localhost:9092`\n  - Consume message: `kafka-console-consumer.sh --topic join-request-alerts --bootstrap-server localhost:9092 --from-beginning`\n  - List topics: `kafka-topics.sh --list --bootstrap-server localhost:9092`\n- **Containerized:**\n  - Run Kafka in Docker: `docker run -d -p 9092:9092 confluentinc/cp-kafka:7.5.0`\n  - Run integration tests: `npm test` (uses Testcontainers to spin up Kafka for tests)\n  - Deploy to Kubernetes: `helm install kafka bitnami/kafka --set replicaCount=3`\n\n### Default Gate Policy\n- **min coverage:** 80% of Kafka producers and consumers covered by integration tests\n- **max criticals:** 0 unacknowledged messages in dead-letter queue, 0 consumer lag >5 minutes\n- **security:** SASL/SCRAM authentication enabled, SSL/TLS encryption enforced, ACLs configured for all topics\n- **performance:** Consumer lag ≤1 minute for all topics, producer throughput ≥1,000 messages/second\n- **reliability:** Replication factor ≥2 for all topics, min.insync.replicas ≥2 for critical topics\n\n### Enterprise Runner Notes\n- **SonarQube:** SonarQube does not natively support Kafka, but custom rules can be added for Kafka client code quality. Use SonarQube to analyze Node.js Kafka producer/consumer code.\n- **Jenkins:** Jenkins pipeline stages: checkout, run Kafka integration tests, deploy Kafka topics, monitor consumer lag. Use Jenkins credentials plugin for Kafka credentials. Store topic configuration in Git, apply changes via Kafka CLI tools.\n- **GitLab CI:** GitLab CI/CD pipeline defined in `.gitlab-ci.yml`. Stages: test, deploy. Use GitLab CI/CD variables for Kafka connection strings. Run integration tests in staging before production.\n- **Azure DevOps:** Azure Pipelines YAML configuration for Kafka deployment. Stages: test, deploy, monitor. Use Azure Key Vault for Kafka credentials. Deploy Kafka to Azure Event Hubs (Kafka-compatible).\n\n### TECH_CONSTRAINTS integration\n- **air-gap:** For air-gapped environments, pre-download Kafka Docker images and Helm charts. Store Kafka configuration in internal Git repository. Use internal artifact repository for Kafka dependencies.\n- **registries:** Configure Kafka Docker image to pull from internal registry (e.g., `registry.internal.company.com/kafka:7.5.0`). Update Kubernetes StatefulSet to use internal registry for Kafka image.\n- **tokens:** Store Kafka SASL credentials in Kubernetes Secrets. Use environment variables to inject credentials into producer/consumer applications. Rotate Kafka passwords every 90 days. Use HashiCorp Vault for centralized secrets management if available."
      },
      {
         "path":"docs/harper/lane-guides/ci.md",
         "content":"## Lane Guide — ci\n\n### Tools\n- **tests:** GitHub Actions for CI/CD, Jenkins for enterprise CI/CD, GitLab CI for GitLab-hosted projects\n- **lint:** YAML linters for CI/CD configuration files (e.g., yamllint)\n- **types:** No type checking for CI/CD configuration, but use schema validation for YAML files\n- **security:** GitHub Secrets for storing credentials, HashiCorp Vault for enterprise secrets management\n- **build:** Docker for building container images, Helm for Kubernetes deployments, Terraform for infrastructure as code\n\n### CLI Examples\n- **Local:**\n  - Validate GitHub Actions workflow: `act -n` (dry-run using act tool)\n  - Lint YAML: `yamllint .github/workflows/*.yml`\n  - Build Docker image: `docker build -t family-frame-api:latest .`\n  - Run Helm chart validation: `helm lint charts/family-frame`\n  - Run Terraform plan: `terraform plan`\n- **Containerized:**\n  - Run CI/CD pipeline locally: `act` (using act tool to run GitHub Actions locally)\n  - Build and push Docker image: `docker build -t registry.internal.company.com/family-frame-api:latest . && docker push registry.internal.company.com/family-frame-api:latest`\n  - Deploy to Kubernetes: `helm upgrade --install family-frame charts/family-frame --namespace staging`\n\n### Default Gate Policy\n- **min coverage:** 100% of critical workflows tested (build, test, deploy), 80% of edge cases covered\n- **max criticals:** 0 failed builds in production pipeline, 0 unhandled errors in deployment scripts\n- **security:** All secrets stored in GitHub Secrets or HashiCorp Vault, no hardcoded credentials in CI/CD configuration\n- **performance:** Build time ≤10 minutes, deployment time ≤5 minutes\n- **reliability:** Rollback mechanism in place for failed deployments, health checks on all deployed services\n\n### Enterprise Runner Notes\n- **SonarQube:** Integrate SonarQube scanner in CI/CD pipeline for code quality analysis. Configure quality gate: coverage ≥80%, duplications ≤3%, maintainability rating A. SonarQube server URL and token stored in GitHub Secrets or Jenkins credentials.\n- **Jenkins:** Jenkins pipeline stages: checkout, install dependencies, run tests, lint, security scan, build Docker image, push to registry, deploy to Kubernetes. Use Jenkins shared libraries for reusable pipeline steps. Artifacts stored in Artifactory or Nexus.\n- **GitLab CI:** GitLab CI/CD pipeline defined in `.gitlab-ci.yml`. Stages: test, lint, security, build, deploy. Use GitLab Container Registry for Docker images. Secrets managed via GitLab CI/CD variables.\n- **Azure DevOps:** Azure Pipelines YAML configuration for multi-stage pipeline. Stages: build, test, security scan, publish artifacts, deploy to AKS. Use Azure Key Vault for secrets management.\n\n### TECH_CONSTRAINTS integration\n- **air-gap:** For air-gapped environments, pre-download CI/CD tools (e.g., Jenkins, GitLab Runner) and Docker images. Store CI/CD configuration in internal Git repository. Use internal artifact repository for dependencies.\n- **registries:** Configure CI/CD pipeline to push Docker images to internal registry (e.g., `registry.internal.company.com`). Update Kubernetes image pull secrets to authenticate with internal registry.\n- **tokens:** Store CI/CD credentials in GitHub Secrets, Jenkins credentials plugin, or HashiCorp Vault. Use environment variables to inject credentials into CI/CD jobs. Rotate credentials every 90 days."
      },
      {
         "path":"docs/harper/lane-guides/infra.md",
         "content":"## Lane Guide — infra\n\n### Tools\n- **tests:** Terraform validate for infrastructure code validation, Helm lint for Kubernetes chart validation, Terratest for infrastructure testing\n- **lint:** tflint for Terraform linting, yamllint for Kubernetes YAML linting\n- **types:** Terraform type constraints, Kubernetes schema validation\n- **security:** Checkov for Terraform security scanning, Trivy for container image vulnerability scanning, Kube-bench for Kubernetes security auditing\n- **build:** Terraform for infrastructure provisioning, Helm for Kubernetes deployments, Ansible for configuration management\n\n### CLI Examples\n- **Local:**\n  - Validate Terraform: `terraform validate`\n  - Lint Terraform: `tflint`\n  - Plan Terraform: `terraform plan`\n  - Apply Terraform: `terraform apply`\n  - Validate Helm chart: `helm lint charts/family-frame`\n  - Deploy Helm chart: `helm upgrade --install family-frame charts/family-frame --namespace staging`\n  - Scan Terraform for security issues: `checkov -d terraform/`\n  - Scan Docker image for vulnerabilities: `trivy image family-frame-api:latest`\n- **Containerized:**\n  - Run Terraform in Docker: `docker run --rm -v $(pwd):/workspace hashicorp/terraform:1.6 validate`\n  - Run Helm in Docker: `docker run --rm -v $(pwd):/workspace alpine/helm:3.13 lint charts/family-frame`\n  - Run Checkov in Docker: `docker run --rm -v $(pwd):/workspace bridgecrew/checkov -d /workspace/terraform`\n\n### Default Gate Policy\n- **min coverage:** 100% of infrastructure components have Terraform or Helm definitions, 80% of infrastructure code covered by Terratest tests\n- **max criticals:** 0 critical vulnerabilities in Checkov scan, 0 high-severity vulnerabilities in Trivy scan, 0 failed Kube-bench checks\n- **security:** All secrets stored in HashiCorp Vault or Kubernetes Secrets, no hardcoded credentials in Terraform or Helm charts, TLS 1.3 enforced for all services\n- **performance:** Infrastructure provisioning time ≤15 minutes, Kubernetes pod startup time ≤2 minutes\n- **reliability:** High availability for all critical services (≥2 replicas), automated backups for stateful services (Postgres, Kafka), disaster recovery plan in place\n\n### Enterprise Runner Notes\n- **SonarQube:** SonarQube does not natively support Terraform or Helm, but custom rules can be added for infrastructure code quality. Use Checkov and tflint output as input to SonarQube for infrastructure quality metrics.\n- **Jenkins:** Jenkins pipeline stages: checkout, validate Terraform, lint Terraform, plan Terraform, apply Terraform, validate Helm, deploy Helm. Use Jenkins credentials plugin for cloud provider credentials. Store infrastructure code in Git, apply changes in staging before production.\n- **GitLab CI:** GitLab CI/CD pipeline defined in `.gitlab-ci.yml`. Stages: validate, lint, plan, apply, deploy. Use GitLab CI/CD variables for cloud provider credentials. Run infrastructure changes in staging before production.\n- **Azure DevOps:** Azure Pipelines YAML configuration for infrastructure deployment. Stages: validate, plan, apply, deploy. Use Azure Key Vault for cloud provider credentials. Deploy infrastructure to Azure using Terraform or ARM templates.\n\n### TECH_CONSTRAINTS integration\n- **air-gap:** For air-gapped environments, pre-download Terraform providers, Helm charts, and Docker images. Store infrastructure code in internal Git repository. Use internal artifact repository for Terraform modules and Helm charts.\n- **registries:** Configure Terraform to use internal provider registry (e.g., `registry.internal.company.com/terraform-providers`). Configure Helm to use internal chart repository (e.g., `registry.internal.company.com/helm-charts`). Update Kubernetes to pull images from internal registry.\n- **tokens:** Store cloud provider credentials in HashiCorp Vault or Kubernetes Secrets. Use environment variables to inject credentials into Terraform and Helm. Rotate credentials every 90 days. Use service accounts with least privilege for infrastructure provisioning."
      }
   ],
   "usage":{
      "input_tokens":11585,
      "cache_creation_input_tokens":0,
      "cache_read_input_tokens":0,
      "cache_creation":{
         "ephemeral_5m_input_tokens":0,
         "ephemeral_1h_input_tokens":0
      },
      "output_tokens":19776,
      "service_tier":"standard"
   },
   "finish_reason":"stop",
   "raw":{
      "id":"msg_01EhGGQPvvnTqZPBhfPtcw6L",
      "model":"claude-sonnet-4-5-20250929",
      "role":"assistant",
      "stop_sequence":"None",
      "tool_uses":[
         
      ]
   },
   "errors":[
      
   ]
}